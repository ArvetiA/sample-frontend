<!DOCTYPE html>
<html lang="en" ng-app="employeeApp">
<head>
  <meta charset="UTF-8">
  <title>Employee Login</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <script src="LoginController.js"></script>
  <script src="LoginService.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #f2f2f2;
      height: 100vh;
    }
    .login-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
    }
    .login-box {
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      width: 320px;
      text-align: center;
    }
    .login-box label {
      display: block;
      margin-top: 10px;
      text-align: left;
    }
    .login-box input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
    }
    .login-box button {
      margin-top: 15px;
      padding: 10px 20px;
      width: 100%;
    }
    .login-box a {
      display: block;
      margin-top: 15px;
      color: #007bff;
      text-decoration: none;
      font-size: 14px;
    }
    form {
      max-width: 500px;
      margin: 20px auto;
      background-color: #ffffff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="email"], input[type="password"], input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      margin-top: 15px;
      padding: 10px 15px;
      background-color: #5c4655;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #6c7177;
    }
  </style>
</head>
<body ng-controller="LoginController">

  <!-- Login Form -->
  <div class="login-wrapper" ng-if="!isLoggedIn && !showForgotPassword && !showResetPasswordForm && !showChangePasswordForm">
    <div class="login-box">
      <h2>Login</h2>
      <form name="loginForm" ng-submit="submitLogin(loginForm)" novalidate>
        <label>Username or Email</label>
        <input type="text" ng-model="loginData.username" required />
        <label>Password</label>
        <input type="password" ng-model="loginData.password" required />
        <button type="submit">Login</button>
        <a href="#" ng-click="showForgotPasswordForm()">Forgot Password?</a>
        <p style="color:red;">{{errorMessage}}</p>
      </form>
    </div>
  </div>

  <!-- Forgot Password -->
  <div ng-if="!isLoggedIn && showForgotPassword">
    <h2 style="text-align:center;">Forgot Password</h2>
    <form name="forgotPasswordForm" ng-submit="forgotPassword(forgotPasswordForm)" novalidate>
      <label>Enter your registered email</label>
      <input type="email" name="forgotEmail" ng-model="forgotData.email" required />
      <button type="submit">Send Reset Link</button>
      <button type="button" ng-click="cancelForgotPassword()">Back</button>
      <p style="color: green;">{{successMessage}}</p>
      <p style="color: red;">{{errorMessage}}</p>
    </form>
  </div>

  <!-- Reset Password -->
  <div ng-if="!isLoggedIn && showResetPasswordForm">
    <h2 style="text-align:center;">Set Your New Password</h2>
    <form name="resetPasswordForm" ng-submit="resetPassword(resetPasswordForm)" novalidate>
      <label>New Password:</label>
      <input type="password" ng-model="resetPasswordData.newPassword" required />
      <button type="submit">Set Password</button>
      <p style="color: green;">{{resetSuccessMessage}}</p>
      <p style="color: red;">{{resetErrorMessage}}</p>
    </form>
  </div>

  <!-- Change Password -->
  <div ng-show="showChangePasswordForm">
    <h3 style="text-align:center;">Change Password</h3>
    <form name="changePasswordForm" ng-submit="changePassword(changePasswordForm)" novalidate>
      <label>Old Password:</label>
      <input type="password" ng-model="passwordData.oldPassword" required />
      <label>New Password:</label>
      <input type="password" ng-model="passwordData.newPassword" required />
      <button type="submit">Update Password</button>
      <p style="color: green">{{changePasswordSuccess}}</p>
      <p style="color: red">{{changePasswordError}}</p>
    </form>
  </div>

  <div ng-if="isLoggedIn && role === 'Employee'">
  <h2 style="text-align:center;">Welcome, {{username}} (Employee)</h2>
  <p style="text-align:center;">Sign-In Time: {{signInTime || 'Not signed in yet'}}</p>
  <p style="text-align:center;">Sign-Out Time: {{signOutTime || 'Not signed out yet'}}</p>

  <div style="text-align:center;">
    <button type="button" ng-click="handleSignIn()" ng-disabled="hasSignedIn">Sign In</button>
    <button type="button" ng-click="handleSignOut()" ng-disabled="!hasSignedIn || hasSignedOut">Sign Out</button>
  </div>
</div>

  <!-- Admin Dashboard -->
  <div ng-if="isLoggedIn && role === 'Admin'">
  <h2>Welcome Admin, redirecting to dashboard...</h2>
</div>
</body>
</html>
